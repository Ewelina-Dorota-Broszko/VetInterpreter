<div class="dashboard-menu-container">
  <div class="container">
    <h2>Formularz badania moczu</h2>

    <form (ngSubmit)="submitForm()" #form="ngForm">

      <!-- Właściwości fizyczne i chemiczne -->
      <fieldset>
        <legend>Właściwości fizyczne i chemiczne</legend>

        <label>Kolor</label>
        <select [(ngModel)]="formData.physicalChemical.color" name="color" required>
          <option value="" disabled>— wybierz —</option>
          <option *ngFor="let c of colors" [value]="c">{{ c }}</option>
        </select>

        <label>Przejrzystość</label>
        <select [(ngModel)]="formData.physicalChemical.clarity" name="clarity">
          <option value="" disabled>— wybierz —</option>
          <option *ngFor="let c of clarities" [value]="c">{{ c }}</option>
        </select>

        <label>Ciężar właściwy (SG)</label>
        <input type="number" step="0.001" min="1.000" max="1.100"
               [(ngModel)]="formData.physicalChemical.specificGravity" name="specificGravity" required />

        <label>pH</label>
        <input type="number" step="0.1" min="4.5" max="9.5"
               [(ngModel)]="formData.physicalChemical.pH" name="pH" required />

        <!-- Półilościowe -->
        <label>Białko</label>
        <select [(ngModel)]="formData.physicalChemical.protein" name="protein" required>
          <option value="" disabled>— wybierz —</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Glukoza</label>
        <select [(ngModel)]="formData.physicalChemical.glucose" name="glucose" required>
          <option value="" disabled>— wybierz —</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Ciała ketonowe</label>
        <select [(ngModel)]="formData.physicalChemical.ketones" name="ketones" required>
          <option value="" disabled>— wybierz —</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Bilirubina</label>
        <select [(ngModel)]="formData.physicalChemical.bilirubin" name="bilirubin">
          <option value="">—</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Urobilinogen</label>
        <select [(ngModel)]="formData.physicalChemical.urobilinogen" name="urobilinogen">
          <option value="">—</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Krew</label>
        <select [(ngModel)]="formData.physicalChemical.blood" name="blood">
          <option value="">—</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Azotyny</label>
        <select [(ngModel)]="formData.physicalChemical.nitrites" name="nitrites">
          <option value="">—</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>

        <label>Esteraza leukocytowa</label>
        <select [(ngModel)]="formData.physicalChemical.leukocyteEsterase" name="leukocyteEsterase">
          <option value="">—</option>
          <option *ngFor="let o of stripOptions" [value]="o.value">{{ o.label }}</option>
        </select>
      </fieldset>

      <!-- Analiza mikroskopowa -->
      <fieldset>
        <legend>Analiza mikroskopowa</legend>

        <label>Leukocyty (WBC) / HPF</label>
        <select [(ngModel)]="formData.microscopic.wbc" name="wbc">
          <option value="">—</option>
          <option *ngFor="let r of wbcRanges" [value]="r">{{ r }}</option>
        </select>

        <label>Erytrocyty (RBC) / HPF</label>
        <select [(ngModel)]="formData.microscopic.rbc" name="rbc">
          <option value="">—</option>
          <option *ngFor="let r of rbcRanges" [value]="r">{{ r }}</option>
        </select>

        <label>Komórki nabłonkowe</label>
        <select [(ngModel)]="formData.microscopic.epithelialCells" name="epithelialCells">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>

        <label>Kryształy</label>
        <select [(ngModel)]="formData.microscopic.crystals" name="crystals">
          <option *ngFor="let c of crystalTypes" [value]="c">{{ c }}</option>
        </select>

        <label>Wałeczki</label>
        <select [(ngModel)]="formData.microscopic.casts" name="casts">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>

        <label>Bakterie</label>
        <select [(ngModel)]="formData.microscopic.bacteria" name="bacteria">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>

        <label>Drożdżaki</label>
        <select [(ngModel)]="formData.microscopic.yeast" name="yeast">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>

        <label>Plemniki</label>
        <select [(ngModel)]="formData.microscopic.sperm" name="sperm">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>

        <label>Pasma śluzu</label>
        <select [(ngModel)]="formData.microscopic.mucus" name="mucus">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>

        <label>Pasożyty</label>
        <select [(ngModel)]="formData.microscopic.parasites" name="parasites">
          <option *ngFor="let q of quantity" [value]="q">{{ q }}</option>
        </select>
      </fieldset>

      <!-- Dodatkowe informacje -->
      <fieldset>
        <legend>Dodatkowe informacje</legend>
        <label>Data badania</label>
        <input type="date" [(ngModel)]="formData.testDate" name="testDate" required />

        <label>Komentarze</label>
        <textarea [(ngModel)]="formData.comments" name="comments" rows="3"></textarea>
      </fieldset>

      <button type="submit" [disabled]="saving">
        {{ saving ? 'Zapisywanie…' : 'Zapisz badanie moczu' }}
      </button>

      <p class="ok" *ngIf="okMsg">{{ okMsg }}</p>
      <p class="error" *ngIf="error">{{ error }}</p>
    </form>
  </div>
</div>
