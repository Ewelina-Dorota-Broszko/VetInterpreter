<!-- meds-tab.component.html -->
<h2>Plan leków</h2>

<canvas #medsChart *ngIf="sorted?.length"></canvas>

<table *ngIf="sorted?.length; else noMeds">
  <thead>
    <tr>
      <th>Nazwa</th>
      <th>Dawka</th>
      <th>Częstotliwość</th>
      <th>Godziny</th>
      <th>Start</th>
      <th>Koniec</th>
      <th>Aktywna</th>
      <th>Akcja</th>
      <th>Uwagi</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let m of sorted; trackBy: trackByIndex">
      <td>{{ m.name }}</td>
      <td>{{ m.dose }}</td>
      <td>{{ m.frequency || '—' }}</td>
      <td>{{ (m.timesOfDay || []).join(', ') || '—' }}</td>
      <td>{{ m.startDate }}</td>
      <td>{{ m.endDate || '—' }}</td>
      <td>
        <span class="pill" [ngClass]="m.isActive ? 'active' : 'inactive'">
          {{ m.isActive ? 'Tak' : 'Nie' }}
        </span>
      </td>
      <td>
        <button
          type="button"
          class="pill toggle"
          [disabled]="!animalId || !m._id || saving.has(m._id)"
          (click)="onToggleActive(m)">
          {{ m.isActive ? 'Wyłącz' : 'Włącz' }}
        </button>
      </td>
      <td>{{ m.notes || '—' }}</td>
    </tr>
  </tbody>
</table>

<ng-template #noMeds>
  <p>Brak aktywnych leków.</p>
</ng-template>
